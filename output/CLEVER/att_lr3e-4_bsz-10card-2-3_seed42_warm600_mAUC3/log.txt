2025-03-14 15:22:00,046 vlpretrain WARNING: Device: cuda, n_gpu: 2
2025-03-14 15:22:00,118 vlpretrain INFO: Evaluate the following checkpoint: /home/zsh/ZSH/Experiment/SMART/pretrained_models/pretrained_base/
2025-03-14 15:22:03,347 vlpretrain INFO: Namespace(model='CLEVER', num_classes=101, train_dir='/home/zsh/ZSH/Experiment/SMART/data', test_dir='/home/zsh/ZSH/Experiment/SMART/data', train_yaml='train.yaml', test_yaml='test.yaml', val_yaml='val.yaml', model_name_or_path=None, output_dir='/home/zsh/ZSH/Experiment/SMART/output/CLEVER/att_lr3e-4_bsz-10card-2-3_seed42_warm600_mAUC3', loss_type='sfmx', config_name='', tokenizer_name='', max_seq_length=70, max_seq_a_length=40, do_train=True, do_test=False, do_eval=False, do_lower_case=True, mask_prob=0.15, max_masked_tokens=3, add_od_labels=False, drop_out=0.1, max_img_seq_length=50, img_feature_dim=2054, img_feature_type='frcnn', tie_weights=False, freeze_embedding=True, label_smoothing=0, drop_worst_ratio=0, drop_worst_after=0, per_gpu_train_batch_size=2, per_gpu_eval_batch_size=2, output_mode='classification', num_labels=2, gradient_accumulation_steps=3, learning_rate=0.0003, weight_decay=0.05, adam_epsilon=1e-08, max_grad_norm=1.0, warmup_steps=600, scheduler='cosine', num_workers=3, num_train_epochs=100, max_steps=-1, logging_steps=20, save_steps=1000, evaluate_during_training=False, no_cuda=False, seed=42, scst=False, sc_train_sample_n=5, sc_baseline_type='greedy', sc_beam_size=1, cider_cached_tokens='coco-train-words.p', eval_model_dir='/home/zsh/ZSH/Experiment/SMART/pretrained_models/pretrained_base/', max_gen_length=20, output_hidden_states=False, num_return_sequences=1, num_beams=1, num_keep_best=1, temperature=1, top_k=0, top_p=1, repetition_penalty=1, length_penalty=1, use_cbs=False, min_constraints_to_satisfy=2, sfmx_t=11.0, loss_w_t=-1.0, attention_w=0.0, head='att', select_size=50, real_bag_size=50, mAUC_weight=3, pretrained_weight='/home/zsh/ZSH/Experiment/SMART/pretrained_models/pretrained_avg_model/model.bin', VRD_weight='', local_rank=0, num_gpus=2, distributed=True, device=device(type='cuda'))
2025-03-14 15:22:11,194 vlpretrain INFO: Train with 2 images per GPU.
2025-03-14 15:22:11,194 vlpretrain INFO: Total batch size 4
2025-03-14 15:22:11,194 vlpretrain INFO: Total training steps 161000
2025-03-14 15:24:31,750 vlpretrain WARNING: Device: cuda, n_gpu: 2
2025-03-14 15:24:31,825 vlpretrain INFO: Evaluate the following checkpoint: /home/zsh/ZSH/Experiment/SMART/pretrained_models/pretrained_base/
2025-03-14 15:24:34,356 vlpretrain INFO: Namespace(model='CLEVER', num_classes=101, train_dir='/home/zsh/ZSH/Experiment/SMART/data', test_dir='/home/zsh/ZSH/Experiment/SMART/data', train_yaml='train.yaml', test_yaml='test.yaml', val_yaml='val.yaml', model_name_or_path=None, output_dir='/home/zsh/ZSH/Experiment/SMART/output/CLEVER/att_lr3e-4_bsz-10card-2-3_seed42_warm600_mAUC3', loss_type='sfmx', config_name='', tokenizer_name='', max_seq_length=70, max_seq_a_length=40, do_train=True, do_test=False, do_eval=False, do_lower_case=True, mask_prob=0.15, max_masked_tokens=3, add_od_labels=False, drop_out=0.1, max_img_seq_length=50, img_feature_dim=2054, img_feature_type='frcnn', tie_weights=False, freeze_embedding=True, label_smoothing=0, drop_worst_ratio=0, drop_worst_after=0, per_gpu_train_batch_size=2, per_gpu_eval_batch_size=2, output_mode='classification', num_labels=2, gradient_accumulation_steps=3, learning_rate=0.0003, weight_decay=0.05, adam_epsilon=1e-08, max_grad_norm=1.0, warmup_steps=600, scheduler='cosine', num_workers=3, num_train_epochs=100, max_steps=-1, logging_steps=20, save_steps=1000, evaluate_during_training=False, no_cuda=False, seed=42, scst=False, sc_train_sample_n=5, sc_baseline_type='greedy', sc_beam_size=1, cider_cached_tokens='coco-train-words.p', eval_model_dir='/home/zsh/ZSH/Experiment/SMART/pretrained_models/pretrained_base/', max_gen_length=20, output_hidden_states=False, num_return_sequences=1, num_beams=1, num_keep_best=1, temperature=1, top_k=0, top_p=1, repetition_penalty=1, length_penalty=1, use_cbs=False, min_constraints_to_satisfy=2, sfmx_t=11.0, loss_w_t=-1.0, attention_w=0.0, head='att', select_size=50, real_bag_size=50, mAUC_weight=3, pretrained_weight='/home/zsh/ZSH/Experiment/SMART/pretrained_models/pretrained_avg_model/model.bin', VRD_weight='', local_rank=0, num_gpus=2, distributed=True, device=device(type='cuda'))
2025-03-14 15:24:41,521 vlpretrain INFO: Train with 2 images per GPU.
2025-03-14 15:24:41,521 vlpretrain INFO: Total batch size 4
2025-03-14 15:24:41,521 vlpretrain INFO: Total training steps 161000
